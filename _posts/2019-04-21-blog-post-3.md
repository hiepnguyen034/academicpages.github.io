---
title: '[Notes] Shapes of CNN'
date: 2019-04-21
permalink: /posts/2019/04/blog-post-3/
tags:
   - Convolutional neural network
---

Since the size of input after convolving, padding and max-pooling can be tricky, I believe having a formula sheet that keeps track of the shape after eaceh operation will come in handy. So, here we go.

Let the input X be a matrix of shape $$(batch-size,n_h,n_w,n_c)$$ and F be a filter of shape $$(f_h,f_w,f_{cin},f_{cout})$$, then output of $$X\circledast F$$ will be of shape $$(batch-size,n_h-f_h+1,n_w-f_w+1,f_{cout})$$. Here,
$$f_{cout}$$ can be understood as the number of filters.

Now, consider padding $$p$$ and stride $$s$$. the shape of $$X\circledast F$$ is of shape $$(batch-size,n_h+2*p-f_h+1,n_w+2*p-f_w+1,f_{cout})$$. Normally, we use padding partly because we do not want the input to shrink too drastically after convolving, and would expect the output to have the exact same heigh and weight as those of the input.
Hence, the widely accepted value of $$p$$ is $$\frac{f-1}{n}$$.

**Example 1**

Consider the case with no padding.

```python
import tensorflow as tf
input=tf.random_normal([1,200,150,3])
filter=tf.random_normal([5,5,3,32])
convo=tf.nn.conv2d(input,filter,strides=[1,1,1,1],padding='VALID') #stride =1 and no padding
with tf.Session() as sess:
	print(sess.run(tf.shape(convo)))
#Out put is of shape [  1 196 146  32]
```

